<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<template th:fragment="header" th:remove="tag">
  <head>
    <meta charset="UTF-8">
    <meta content="width=device-width,initial-scale=1,minimal-ui" name="viewport">

    <title>NiiuChat</title>

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700,400italic|Material+Icons">
    <link rel="stylesheet" href="https://unpkg.com/vue-material/dist/vue-material.min.css">
    <link rel="stylesheet" href="https://unpkg.com/vue-material/dist/theme/default.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <link rel="stylesheet" href="/css/niiu-common.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pubsub-js/1.9.3/pubsub.min.js"></script>
  </head>
</template>

<template th:fragment="after-imports" th:remove="tag">
  <!-- libraries -->
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script th:if="${#arrays.contains(@environment.getActiveProfiles(), 'production')}"
          src="https://cdn.jsdelivr.net/npm/vue@2.6.12"></script>
  <script th:unless="${#arrays.contains(@environment.getActiveProfiles(), 'production')}"
          src="https://cdn.jsdelivr.net/npm/vue@2.6.12/dist/vue.js"></script>
  <script src="https://unpkg.com/vue-material"></script>
  <script src="https://cdn.jsdelivr.net/npm/vuelidate@0.7.6/dist/vuelidate.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vuelidate@0.7.6/dist/validators.min.js"></script>

  <!-- Constants -->
  <script src="/js/niiu-events.js"></script>

  <!-- WebSocket -->
  <script src="/js/live.js"></script>

  <!-- functions -->
  <script src="/js/user-api.js"></script>
  <script src="/js/chats-api.js"></script>

  <!-- niiu components -->
  <script src="/components/progress-bar/niiu-progress-bar.js"></script>
  <script src="/components/check-animation/niiu-check-animation.js"></script>
  <script src="/components/toolbar/niiu-toolbar.js"></script>
  <script src="/components/profile/niiu-profile-image-upload.js"></script>
  <script src="/components/profile/niiu-profile-form-data.js"></script>
  <script src="/components/profile/niiu-profile-form-password.js"></script>
  <script src="/components/profile/niiu-profile.js"></script>
  <script src="/components/chat/niiu-chat-input.js"></script>
  <script src="/components/chat/niiu-chat.js"></script>
  <script src="/components/chats/niiu-chats.js"></script>
  <script src="/components/chats/niiu-create-chats.js"></script>

  <script>
    Vue.use(VueMaterial.default);
    Vue.use(vuelidate.default);

    axios.interceptors.response.use(function (response) {
      return response;
    }, function (error) {
      if (error.response.status === 401) {
        window.location = '/login';
        return;
      }

      return Promise.reject(error);
    });
  </script>
</template>
</html>
